prontera,169,162,3	script	Blessing Assistant	10892,{
	mes "^00B2EE[ Blessing Assistant ]^000000";
    if ($exp_boost_active == 1) {
        mes "The server-wide EXP and Drop Rate boost is currently active!";
        close;
    }

    mes "We are collecting donations to provide a server-wide EXP and Drop Rate boost!";
    mes "Please donate at least " + .min_donation + " Zeny.";
    next;
    mes "^00B2EE[ Blessing Assistant ]^000000";
    mes "How much would you like to donate?";
    input .@donation;

    if (.@donation < .min_donation) {
        mes "The minimum donation is " + .min_donation + " Zeny.";
        close;
    }

    if (Zeny < .@donation) {
        mes "You do not have enough Zeny.";
        close;
    }
	// Deduct the donation from the player
    set Zeny, Zeny - .@donation;
	sc_start SC_INCREASEAGI, 1800000, 10; // Increase Agility level 10 for 30 minutes (1800 seconds)
	sc_start SC_BLESSING, 1800000, 10; // Blessing level 10 for 30 minutes (1800 seconds)
	sc_start SC_ANGELUS, 1800000, 10; // Angelus level 10 for 30 minutes (1800 seconds)
	sc_start SC_MAGNIFICAT, 1800000, 10;
	if (.@donation >= 50000 ) {
	sc_start SC_INCREASEAGI, 2700000, 10; // Increase Agility level 10 for 30 minutes (1800 seconds)
	sc_start SC_BLESSING, 2700000, 10; // Blessing level 10 for 30 minutes (1800 seconds)
	sc_start SC_ANGELUS, 2700000, 10; // Angelus level 10 for 30 minutes (1800 seconds)
	sc_start SC_MAGNIFICAT, 2700000, 10;
		sc_start SC_STRFOOD, 2700000,2;
		sc_start SC_AGIFOOD, 2700000,2;
		sc_start SC_VITFOOD, 2700000,2;
		sc_start SC_INTFOOD, 2700000,2;
		sc_start SC_DEXFOOD, 2700000,2;
		sc_start SC_LUKFOOD, 2700000,2;
		specialeffect2 EF_PORTAL,AREA;
		specialeffect2 EF_BASH3D;
	}
//	specialeffect2 EF_MAGNIFICAT;
 //       specialeffect2 EF_ANGELUS;
   //     specialeffect2 EF_BLESSING;
    //    specialeffect2 EF_INCREASEAGI;
	
	specialeffect2 EF_ICECRASH;
	specialeffect EF_COLTHROW2;
	announce "[" + strcharinfo(0) + "] donated " + .@donation + " zeny to feed Blessing Assistant", bc_all;
   
   // Add the donation to the total
    set .total_zeny_collected, .total_zeny_collected + .@donation;

    mes "Thank you for your donation!";
	if (.total_zeny_collected >= 10000000) {
        mes "The donation goal has been reached!";
        mes "The server-wide EXP and Drop Rate boost will be activated for 6 hours!";
        set $exp_boost_active, 1;
	set .total_zeny_collected, 0;
        donpcevent "Blessing Assistant::OnExpBoostStart";
   
   } else {
        mes "We have collected " + .total_zeny_collected + " Zeny so far.";
        mes "We need " + (10000000 - .total_zeny_collected) + " more Zeny to reach our goal.";
    }
	close;
	
	OnInit: // executes on server restart and/or @reloadscript
		// Save original values
		.base_exp = getbattleflag("base_exp_rate");
		.job_exp = getbattleflag("job_exp_rate");
		.item_common = getbattleflag("item_rate_common");
		.item_equip = getbattleflag("item_rate_equip");
		.item_heal = getbattleflag("item_rate_heal");
		.item_use = getbattleflag("item_rate_use");
		.min_donation = 20000;
		.exp_boost_duration = 10800; // 6 hours in seconds
		.total_zeny_collected = 0; // Reset counters
		$exp_boost_active = 0;
		// Interval in seconds
		.interval = 1;
		while(1) {
		showscript "Blessing Assistant: " + .total_zeny_collected + "/10,000,000", getnpcid(0);
		sleep 1000;
	}
		end;
		

	OnExpBoostStart:
        // Announce to the server
        announce "The Blessing Assistant: EXP and Drop Rate boost has been activated for 3 hours!", bc_all;
		setbattleflag "base_exp_rate",450;
		setbattleflag "job_exp_rate",450;
		setbattleflag "item_rate_common",300;
		setbattleflag "item_rate_equip",300;
		setbattleflag "item_rate_heal",300;
		setbattleflag "item_rate_use",300,true;
		// Initialize the counter variable
		set .counter, 0;
		initnpctimer;
        end;

    OnTimer1000:
		// Increment the counter
		set .counter, .counter + 1;
		
        if (.counter >= .exp_boost_duration) {
			atcommand "@reloadbattleconf";

            // Reset the total collected Zeny and the boost status
            set $exp_boost_active, 0;

            // Announce to the server
            announce "The Blessing Assistant: EXP and Drop Rate boost has ended.", bc_all;
			stopnpctimer;
			end;
        }
		// Restart the timer
		initnpctimer;
        end;
		
}

s_room,56,65,4	script	Blessing Soul	10295,{

	// Check if the player is a GM with group ID 99
	if (getgmlevel() < 99) {
		mes "[GM Access NPC]";
		mes "You do not have permission to access this NPC.";
		close;
	}

	// Display NPC options
	mes "[Blessing Soul]";
	mes "Welcome, GM!";
	mes "This is a console for Blessing Assistant.";
	next;

	switch(select("Activate Blessing Assistant!:Deactivate Blessing Assistant:Cancel")) {
		case 1:
			mes "[Blessing Soul]";
			mes "Blessing Assistant Activated.";
			setbattleflag "base_exp_rate",450;
			setbattleflag "job_exp_rate",450;
			setbattleflag "item_rate_common",300;
			setbattleflag "item_rate_equip",300;
			setbattleflag "item_rate_heal",300;
			setbattleflag "item_rate_use",300,true;
			set $exp_boost_active, 1;
			announce "The Blessing Assistant: EXP and Drop Rate boost has been activated by a GM: "+ strcharinfo(0), bc_all;
			close;
		case 2:
			mes "[Blessing Soul]";
			mes "Blessing Assistant Deactivated.";
			// Add your 'Stop' functionality here
			atcommand "@reloadbattleconf";
			set $exp_boost_active, 0;
			announce "The Blessing Assistant: EXP and Drop Rate boost has been deactivated by a GM!", bc_all;
			close;
		case 3:
			mes "[Blessing Soul]";
			mes "You chose to Cancel.";
			close;
		while(1) {
		showscript "Blessing Soul";
		sleep 1000;
	}
	}
}

-	script	Blessing_Login	-1,{
OnPCLoginEvent:
		if ($exp_boost_active == 1) {
        dispbottom "Blessing Assistant is currently activated. ";
		end;
    }
	}

//comodo,181,153,2	duplicate(Blessing Assistant)	Blessing Assistant#cmd	10892
//prontera,152,192,2	duplicate(Blessing Assistant)	Blessing Assistant#prt	10892
//alberta,31,240,2	duplicate(Blessing Assistant)	Blessing Assistant#alb	10892
//geffen,115,67,2	duplicate(Blessing Assistant)	Blessing Assistant#gef	10892
//izlude,128,143,6	duplicate(Blessing Assistant)	Blessing Assistant#iz	10892
//aldebaran,135,113,2	duplicate(Blessing Assistant)	Blessing Assistant#ald	10892
//morocc,165,97,2	duplicate(Blessing Assistant)	Blessing Assistant#moc	10892







